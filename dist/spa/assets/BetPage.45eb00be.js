import{i as ee,a7 as U,a8 as te,c as B,l as ae,h as H,g as se,k as oe,aO as T,aP as le,d as Y,al as j,as as v,aq as k,ar as i,j as s,aA as l,ax as c,au as P,aw as S,az as w,at as C,aF as E,ay as Q,aS as G,aT as K,an as ne,r as y,o as re,ap as ie,aK as I,F as ue,aL as de,aE as ce,aC as pe,aU as q,aB as L,aD as fe,E as z,y as ge}from"./index.44f6ce53.js";import{Q as me}from"./QSpinnerTail.90e46a57.js";import{Q as be}from"./QPage.5bc6551c.js";import{C as M}from"./ClosePopup.127b782c.js";import{u as ye}from"./use-quasar.14d0d952.js";import{u as ve}from"./vue-i18n.ecbb3cba.js";import{u as he}from"./app.0ca77772.js";const Be={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function $e(){const{props:e,proxy:{$q:t}}=se(),n=ee(te,U);if(n===U)return console.error("QPageSticky needs to be child of QLayout"),U;const $=B(()=>{const o=e.position;return{top:o.indexOf("top")>-1,right:o.indexOf("right")>-1,bottom:o.indexOf("bottom")>-1,left:o.indexOf("left")>-1,vertical:o==="top"||o==="bottom",horizontal:o==="left"||o==="right"}}),u=B(()=>n.header.offset),p=B(()=>n.right.offset),d=B(()=>n.footer.offset),a=B(()=>n.left.offset),h=B(()=>{let o=0,f=0;const g=$.value,_=t.lang.rtl===!0?-1:1;g.top===!0&&u.value!==0?f=`${u.value}px`:g.bottom===!0&&d.value!==0&&(f=`${-d.value}px`),g.left===!0&&a.value!==0?o=`${_*a.value}px`:g.right===!0&&p.value!==0&&(o=`${-_*p.value}px`);const m={transform:`translate(${o}, ${f})`};return e.offset&&(m.margin=`${e.offset[1]}px ${e.offset[0]}px`),g.vertical===!0?(a.value!==0&&(m[t.lang.rtl===!0?"right":"left"]=`${a.value}px`),p.value!==0&&(m[t.lang.rtl===!0?"left":"right"]=`${p.value}px`)):g.horizontal===!0&&(u.value!==0&&(m.top=`${u.value}px`),d.value!==0&&(m.bottom=`${d.value}px`)),m}),A=B(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function O(o){const f=ae(o.default);return H("div",{class:A.value,style:h.value},e.expand===!0?f:[H("div",f)])}return{$layout:n,getStickyContent:O}}var Ee=oe({name:"QPageSticky",props:Be,setup(e,{slots:t}){const{getStickyContent:n}=$e();return()=>n(t)}}),_e={isAuthenticated:e=>!!e.token,getToken:e=>e.token},ke={async getBetById(e){const t=await T.get(`/bet/${e}`);if(!t)return"No bets found";if(t.status===200)return t.data},async getBets(){const e=await T.get("/bet");if(!e)return"No bet found";if(e.status===200)return e.data},async createBet(e){const t=await T.post("/bet",e);if(!t)return"Bet creation failed";if(t.status===201)return t.data},async updateBet(e){const t=await T.patch(`/bet/${e.id}`,e);if(!t)return"Bet update failed";if(t.status===200)return t.data},async deleteBet(e){const t=await T.delete(`/bet/${e}`);if(!t)return"Bet delete failed";if(t.status===200)return t.data}};const Te=le("bet",{state:()=>({info:null}),getters:_e,actions:ke});const Ce=Y({name:"BetCardComponent",props:{bet:{type:Object,required:!0},user:{type:Object,required:!0}},emits:["udpateBet"],setup(e,{emit:t}){function n(){t("udpateBet",{mode:"update",bet:e.bet})}return{onUpdateBet:n}}}),Se=e=>(G("data-v-43c695f2"),e=e(),K(),e),we={class:"text-capitalize"},Ae=Se(()=>l("br",null,null,-1));function De(e,t,n,$,u,p){return e.bet&&e.user?(v(),k(Q,{key:0,class:P(["bet row items-center q-my-sm",e.user.id===e.bet.user_id?"bg-dark":"bg-secondary"])},{default:i(()=>[s(w,{class:"col q-py-sm"},{default:i(()=>[l("p",{class:P([e.user.id===e.bet.user_id?"text-secondary":"text-primary","text-capitalize"])},[l("small",null,c(e.user.id===e.bet.user_id?e.$t("YOU"):e.bet.name),1)],2),l("p",{class:P(["q-ml-md text-center",e.user.id===e.bet.user_id?"text-primary":"text-accent"])},[l("span",we,c(e.bet.gender),1),S(" - "+c(e.bet.height)+" - "+c(e.bet.weight)+" ",1),Ae,S(" "+c(e.bet.extra),1)],2)]),_:1}),s(w,{class:"q-py-sm"},{default:i(()=>[e.user.id===e.bet.user_id?(v(),k(C,{key:0,onClick:e.onUpdateBet,flat:"",round:"",color:"primary",icon:"edit"},null,8,["onClick"])):E("",!0)]),_:1})]),_:1},8,["class"])):E("",!0)}var Ve=j(Ce,[["render",De],["__scopeId","data-v-43c695f2"]]);const Ie=Y({name:"IndexPage",components:{BetCard:Ve},setup(){const e=ye(),t=ve(),n=he(),$=ne(),u=Te(),p=y([]),d=y(!1),a=y(!1),h=y(!1),A=y(null),O=B(()=>h.value?`${t.t("CREATE_YOUR_BET")}`:`${t.t("UPDATE_YOUR_BET")}`),o=y(null),f=y(null),g=y(null),_=y(null),m=y(null);function W(){n.$patch({appTitle:"Bet"}),A.value=$.getUserInfo,D()}re(async()=>{W()});async function D(){d.value=!0;try{const r=await u.getBets();p.value=r;const b=p.value.map(V=>V.user_id);h.value=!b.includes($.user.id)}catch(r){console.log("Failed to get data",r)}finally{d.value=!1}}async function J(){try{await u.deleteBet(m.value)&&e.notify({type:"positive",message:`${t.t("BET_DELETED")}`})}catch{response&&e.notify({type:"negative",message:`${t.t("FAILED_TO_DELETE_BET")}`})}finally{D(),a.value=!1}}async function Z(){d.value=!0;const r={gender:o.value,height:f.value,weight:g.value,extra:_.value,userId:$.user.id,id:m.value};try{let b;h.value?(b=await u.createBet(r),b&&e.notify({type:"positive",message:`${t.t("BET_ADDED")}`})):(b=await u.updateBet(r),b&&e.notify({type:"positive",message:`${t.t("BET_UPDATED")}`})),D()}catch{e.notify({type:"negative",message:`${t.t("FAILED_TO_ADD_BET")}`}),console.log("failed to create bets")}finally{}}async function x(r){var b,V,N,R,F;o.value=((b=r.bet)==null?void 0:b.gender)||null,f.value=((V=r.bet)==null?void 0:V.height)||null,g.value=((N=r.bet)==null?void 0:N.weight)||null,_.value=((R=r.bet)==null?void 0:R.extra)||null,m.value=((F=r.bet)==null?void 0:F.id)||null,a.value=!a.value}return{onOpenBetDialog:x,getBets:D,submit:Z,bets:p,user:A,loadingBets:d,deleteBet:J,displayBetDialog:a,displayCreateBetBtn:h,getDialogLabel:O,gender:o,height:f,weight:g,extra:_}}}),X=e=>(G("data-v-57dc1f2c"),e=e(),K(),e),Oe={class:"column"},Ue={class:"column items-center"},Pe={class:"text-center"},qe=X(()=>l("br",null,null,-1)),Le=X(()=>l("br",null,null,-1)),Qe={class:"card--bet no-wrap column"},Ne={key:0,class:"no-bet q-mt-lg"},Re={key:1,class:"no-bet q-mt-lg"},Fe={key:2,class:"bet__container"},He={class:"q-ml-sm text-accent"},ze={class:"q-gutter-sm"};function Me(e,t,n,$,u,p){const d=ie("bet-card");return v(),k(be,{class:"page"},{default:i(()=>[s(ge,null,{default:i(()=>[l("div",Oe,[l("div",Ue,[s(Q,{class:"col-1-md card bg-grey-lighter padding-none"},{default:i(()=>[s(w,{class:"bg-accent"},{default:i(()=>[l("p",Pe,[S(c(e.$t("THE_BEST_ARE_OPEN"))+" ",1),qe,S(" "+c(e.$t("YOU_CAN_CHANGE_THEM_AT_ANY_TIME"))+" ",1),Le,S(" "+c(e.$t("SURPRISE_PREPARATION")),1)])]),_:1})]),_:1}),l("div",Qe,[e.loadingBets?(v(),I("div",Ne,[s(me,{color:"accent",size:"2em"})])):E("",!0),!e.bets.length&&!e.loadingBets?(v(),I("div",Re,[l("p",null,c(e.$t("NO_BETS_YET")),1),l("p",null,c(e.$t("BE_THE_FIRST")),1)])):E("",!0),e.bets.length&&!e.loadingBets?(v(),I("div",Fe,[(v(!0),I(ue,null,de(e.bets,(a,h)=>(v(),k(d,{key:h,bet:a,user:e.user,onUdpateBet:e.onOpenBetDialog},null,8,["bet","user","onUdpateBet"]))),128))])):E("",!0)])]),s(ce,{modelValue:e.displayBetDialog,"onUpdate:modelValue":t[7]||(t[7]=a=>e.displayBetDialog=a),class:"dialog--bet"},{default:i(()=>[s(Q,{class:"bg-secondary"},{default:i(()=>[s(w,{class:"row justify-center"},{default:i(()=>[l("p",He,c(e.getDialogLabel),1)]),_:1}),s(w,{class:""},{default:i(()=>[l("form",{onSubmit:t[6]||(t[6]=pe((...a)=>e.submit&&e.submit(...a),["prevent"]))},[l("div",ze,[s(q,{modelValue:e.gender,"onUpdate:modelValue":t[0]||(t[0]=a=>e.gender=a),color:"accent","checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",val:"male",label:e.$t("MALE"),class:"radio--input"},null,8,["modelValue","label"]),s(q,{modelValue:e.gender,"onUpdate:modelValue":t[1]||(t[1]=a=>e.gender=a),color:"accent","checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",val:"female",label:e.$t("FEMALE"),class:"radio--input"},null,8,["modelValue","label"]),s(q,{modelValue:e.gender,"onUpdate:modelValue":t[2]||(t[2]=a=>e.gender=a),color:"accent","checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",val:"other",label:e.$t("OTHER"),class:"radio--input"},null,8,["modelValue","label"])]),s(L,{modelValue:e.height,"onUpdate:modelValue":t[3]||(t[3]=a=>e.height=a),standout:"","bg-color":"accent",placeholder:e.$t("HEIGHT"),class:"input__bet q-my-sm"},null,8,["modelValue","placeholder"]),s(L,{modelValue:e.weight,"onUpdate:modelValue":t[4]||(t[4]=a=>e.weight=a),standout:"","bg-color":"accent",placeholder:e.$t("WEIGHT"),class:"input__bet q-my-sm"},null,8,["modelValue","placeholder"]),s(L,{modelValue:e.extra,"onUpdate:modelValue":t[5]||(t[5]=a=>e.extra=a),standout:"","bg-color":"accent",placeholder:e.$t("EXTRA_OPTIONAL"),class:"input__bet q-my-sm"},null,8,["modelValue","placeholder"])],32)]),_:1}),s(fe,{align:"between"},{default:i(()=>[l("div",null,[e.displayCreateBetBtn?E("",!0):(v(),k(C,{key:0,label:e.$t("DELETE"),color:"info",onClick:e.deleteBet},null,8,["label","onClick"]))]),l("div",null,[z(s(C,{flat:"",label:e.$t("CANCEL"),color:"accent"},null,8,["label"]),[[M]]),z(s(C,{label:e.$t("LETS_ROLL"),color:"accent",onClick:e.submit,disable:!e.gender||!e.height||!e.weight},null,8,["label","onClick","disable"]),[[M]])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e.displayCreateBetBtn?(v(),k(Ee,{key:0,position:"bottom-right",offset:[20,20]},{default:i(()=>[s(C,{label:e.$t("MAKE_A_BET"),rounded:"",color:"accent",onClick:t[8]||(t[8]=a=>e.onOpenBetDialog({mode:"create"}))},null,8,["label"])]),_:1})):E("",!0)])]),_:1})]),_:1})}var Ze=j(Ie,[["render",Me],["__scopeId","data-v-57dc1f2c"]]);export{Ze as default};
